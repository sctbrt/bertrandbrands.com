<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">

    <!-- SEO -->
    <link rel="canonical" href="https://bertrandbrands.com/intake/exploratory">
    <meta name="theme-color" content="#0a0a0a">
    <meta name="robots" content="noindex, nofollow">
    <title>Guided Intake | Bertrand Brands</title>
    <meta name="description" content="Tell us about your business and what's on your mind. We'll review and follow up with the right next step.">

    <!-- Favicon & Touch Icons -->
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="Bertrand Brands" />
    <link rel="manifest" href="/site.webmanifest" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,300;9..144,400&family=Inter:opsz,wght@14..32,300;14..32,400;14..32,500;14..32,600&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="/styles/main.css">

    <style>
        .intake-page {
            min-height: 100vh;
            padding-top: 80px;
            position: relative;
            overflow: hidden;
        }

        .intake-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            padding: var(--space-sm) 1.5rem;
            background: rgba(10, 10, 10, 0.9);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
        }

        .intake-header__inner {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .intake-header__back {
            font-size: 0.8125rem;
            color: var(--text-muted);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.375rem;
            transition: color 0.2s ease;
            min-width: 80px;
        }

        .intake-header__back:hover {
            color: var(--text);
        }

        .intake-header__back svg {
            width: 16px;
            height: 16px;
        }

        .intake-header__logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
            color: var(--text);
        }

        .intake-header__logo-icon {
            width: 24px;
            height: auto;
            filter: brightness(0) invert(1);
        }

        .intake-header__logo-text {
            font-family: 'Inter', -apple-system, sans-serif;
            font-size: 0.8125rem;
            font-weight: 500;
            letter-spacing: 0.05em;
            text-transform: uppercase;
            color: var(--text);
        }

        .intake-header__spacer {
            min-width: 80px;
        }

        .intake-content {
            max-width: 560px;
            margin: 0 auto;
            padding: var(--space-2xl, 4rem) 1.5rem;
        }

        .intake-brand {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: var(--space-xs);
        }

        .intake-brand__mark {
            width: 24px;
            height: 24px;
            filter: brightness(0) invert(1);
        }

        .intake-brand__name {
            font-family: 'Fraunces', Georgia, serif;
            font-size: 1.125rem;
            font-weight: 300;
            letter-spacing: 0.02em;
            color: #2563EB;
        }

        .intake-title {
            font-family: 'Inter', -apple-system, sans-serif;
            font-size: clamp(1.75rem, 4vw, 2.25rem);
            font-weight: 300;
            line-height: 1.2;
            margin-bottom: var(--space-sm);
            color: var(--text);
            text-align: center;
        }

        .intake-subtitle {
            font-size: var(--text-sm);
            color: var(--text-muted);
            text-align: center;
            margin-bottom: var(--space-lg);
            line-height: 1.6;
        }

        /* Progress Bar */
        .intake-progress {
            margin-bottom: var(--space-xl);
        }

        .intake-progress__bar {
            height: 3px;
            background: var(--border);
            border-radius: 2px;
            overflow: hidden;
        }

        .intake-progress__fill {
            height: 100%;
            background: #2563EB;
            transition: width 0.3s ease;
        }

        .intake-progress__text {
            font-size: var(--text-xs);
            color: var(--text-subtle);
            text-align: center;
            margin-top: var(--space-xs);
        }

        /* Form Steps */
        .intake-form {
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
        }

        .intake-step {
            display: none;
        }

        .intake-step.active {
            display: block;
        }

        .intake-step__title {
            font-family: 'Inter', -apple-system, sans-serif;
            font-size: var(--text-lg);
            font-weight: 500;
            color: var(--text);
            margin-bottom: var(--space-md);
        }

        .intake-form__group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: var(--space-md);
        }

        .intake-form__label {
            font-size: var(--text-sm);
            font-weight: 500;
            color: var(--text);
        }

        .intake-form__label span {
            font-weight: 400;
            color: var(--text-subtle);
        }

        .intake-form__input,
        .intake-form__textarea,
        .intake-form__select {
            background: var(--bg-alt, #0d0d0d);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            padding: 0.875rem 1rem;
            font-size: var(--text-base);
            color: var(--text);
            font-family: inherit;
            transition: border-color var(--duration-fast) var(--ease-out);
            width: 100%;
        }

        .intake-form__input:focus,
        .intake-form__textarea:focus,
        .intake-form__select:focus {
            outline: none;
            border-color: #2563EB;
        }

        .intake-form__input::placeholder,
        .intake-form__textarea::placeholder {
            color: var(--text-subtle);
        }

        .intake-form__textarea {
            min-height: 120px;
            resize: vertical;
        }

        .intake-form__select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23888888' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            padding-right: 2.5rem;
        }

        .intake-form__help {
            font-size: var(--text-xs);
            color: var(--text-subtle);
            line-height: 1.5;
        }

        /* Validation States */
        .intake-form__input:invalid:not(:placeholder-shown),
        .intake-form__textarea:invalid:not(:placeholder-shown),
        .intake-form__select:invalid:not([data-pristine]) {
            border-color: #EF4444;
        }

        .intake-form__input:valid:not(:placeholder-shown),
        .intake-form__textarea:valid:not(:placeholder-shown) {
            border-color: #10B981;
        }

        .intake-form__error {
            font-size: var(--text-xs);
            color: #EF4444;
            margin-top: 0.25rem;
            display: none;
        }

        .intake-form__group.has-error .intake-form__error {
            display: block;
        }

        .intake-form__group.has-error .intake-form__input,
        .intake-form__group.has-error .intake-form__textarea {
            border-color: #EF4444;
        }

        /* Toast Notifications */
        .intake-toast {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            padding: 1rem 1.5rem;
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            font-weight: 500;
            z-index: 9999;
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
            max-width: calc(100% - 48px);
            text-align: center;
        }

        .intake-toast.visible {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        .intake-toast--error {
            background: #7F1D1D;
            color: #FCA5A5;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .intake-toast--success {
            background: #14532D;
            color: #86EFAC;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        /* Loading Spinner */
        .intake-nav__btn--loading {
            position: relative;
            color: transparent !important;
        }

        .intake-nav__btn--loading::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            top: 50%;
            left: 50%;
            margin-left: -10px;
            margin-top: -10px;
            border: 2px solid rgba(255,255,255,0.3);
            border-top-color: #fff;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Radio/Checkbox Options */
        .intake-options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .intake-option {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 1rem;
            background: var(--bg-alt, #0d0d0d);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: border-color var(--duration-fast) var(--ease-out), background var(--duration-fast) var(--ease-out);
        }

        .intake-option:hover {
            border-color: var(--text-subtle);
        }

        .intake-option input {
            margin-top: 0.125rem;
            accent-color: #2563EB;
        }

        .intake-option input:checked + .intake-option__content {
            color: var(--text);
        }

        .intake-option:has(input:checked) {
            border-color: #2563EB;
            background: rgba(37, 99, 235, 0.05);
        }

        .intake-option__content {
            flex: 1;
        }

        .intake-option__label {
            font-size: var(--text-sm);
            font-weight: 500;
            color: var(--text);
            margin-bottom: 0.125rem;
        }

        .intake-option__description {
            font-size: var(--text-xs);
            color: var(--text-muted);
            line-height: 1.5;
        }

        /* Navigation Buttons */
        .intake-nav {
            display: flex;
            gap: var(--space-sm);
            margin-top: var(--space-lg);
        }

        .intake-nav__btn {
            flex: 1;
            padding: 1rem 1.5rem;
            font-size: var(--text-base);
            font-weight: 500;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease-out);
        }

        .intake-nav__btn--back {
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-muted);
        }

        .intake-nav__btn--back:hover {
            border-color: var(--text-subtle);
            color: var(--text);
        }

        .intake-nav__btn--next,
        .intake-nav__btn--submit {
            background: #2563EB;
            border: none;
            color: #fff;
        }

        .intake-nav__btn--next:hover,
        .intake-nav__btn--submit:hover {
            background: #1D4ED8;
        }

        .intake-nav__btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .intake-nav__btn--hidden {
            visibility: hidden;
        }

        /* Success State */
        .intake-success {
            text-align: center;
            padding: var(--space-2xl, 4rem) 0;
            display: none;
        }

        .intake-success.active {
            display: block;
        }

        .intake-form.hidden {
            display: none;
        }

        .intake-success__icon {
            width: 72px;
            height: 72px;
            margin: 0 auto var(--space-md);
            background: rgba(37, 99, 235, 0.15);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .intake-success__icon svg {
            width: 36px;
            height: 36px;
            color: #2563EB;
        }

        .intake-success__title {
            font-family: 'Inter', -apple-system, sans-serif;
            font-size: var(--text-2xl);
            font-weight: 400;
            margin-bottom: var(--space-sm);
            color: var(--text);
        }

        .intake-success__text {
            font-size: var(--text-base);
            color: var(--text-muted);
            line-height: 1.7;
            max-width: 440px;
            margin: 0 auto var(--space-lg);
        }

        .intake-success__next {
            background: rgba(37, 99, 235, 0.1);
            border: 1px solid rgba(37, 99, 235, 0.2);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-lg);
        }

        .intake-success__next-title {
            font-size: var(--text-sm);
            font-weight: 500;
            color: var(--text);
            margin-bottom: var(--space-xs);
        }

        .intake-success__next-text {
            font-size: var(--text-sm);
            color: var(--text-muted);
            line-height: 1.6;
        }

        .intake-success__cta {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            background: #2563EB;
            border: none;
            color: #fff;
            font-size: var(--text-base);
            font-weight: 500;
            border-radius: var(--radius-md);
            text-decoration: none;
            transition: background var(--duration-fast) var(--ease-out);
            margin-bottom: var(--space-md);
        }

        .intake-success__cta:hover {
            background: #1D4ED8;
        }

        .intake-success__alt {
            font-size: var(--text-sm);
            color: var(--text-subtle);
        }

        .intake-success__alt a {
            color: #2563EB;
            text-decoration: none;
        }

        .intake-success__alt a:hover {
            text-decoration: underline;
        }

        /* Footer */
        .intake-footer {
            border-top: 1px solid var(--border);
            padding: var(--space-xl, 3rem) 1.5rem;
            text-align: center;
            margin-top: var(--space-2xl, 4rem);
        }

        .intake-footer__text {
            font-size: var(--text-sm);
            color: var(--text-subtle);
        }

        /* Spotlights */
        .intake-spotlight {
            position: fixed;
            border-radius: 50%;
            filter: blur(120px);
            pointer-events: none;
            z-index: 0;
            opacity: 0.6;
        }

        .intake-spotlight--blue {
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(37, 99, 235, 0.15) 0%, transparent 70%);
            bottom: -100px;
            left: -100px;
        }

        .intake-spotlight--cyan {
            width: 250px;
            height: 250px;
            background: radial-gradient(circle, rgba(6, 182, 212, 0.1) 0%, transparent 70%);
            top: 80px;
            right: -80px;
        }

        @media (max-width: 768px) {
            .intake-spotlight {
                filter: blur(80px);
            }
            .intake-spotlight--blue {
                width: 200px;
                height: 200px;
            }
            .intake-spotlight--cyan {
                width: 180px;
                height: 180px;
            }
        }
    </style>
</head>
<body>
    <!-- Ambient Spotlights -->
    <div class="intake-spotlight intake-spotlight--blue" aria-hidden="true"></div>
    <div class="intake-spotlight intake-spotlight--cyan" aria-hidden="true"></div>

    <!-- Header -->
    <header class="intake-header">
        <div class="intake-header__inner">
            <a href="/exploratory" class="intake-header__back">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
                Back
            </a>
            <a href="/?skip" class="intake-header__logo">
                <img src="/assets/bertrand-brands-logomark.png" alt="" class="intake-header__logo-icon">
                <span class="intake-header__logo-text">Bertrand Brands</span>
            </a>
            <div class="intake-header__spacer"></div>
        </div>
    </header>

    <main class="intake-page">
        <div class="intake-content">
            <div class="intake-brand">
                <img src="/assets/bertrand-brands-logomark.png" alt="" class="intake-brand__mark">
                <span class="intake-brand__name">Exploratory</span>
            </div>
            <h1 class="intake-title">Guided Intake</h1>
            <p class="intake-subtitle">Tell us about your business and what's on your mind. Takes about 5 minutes.</p>

            <!-- Progress Bar -->
            <div class="intake-progress">
                <div class="intake-progress__bar">
                    <div class="intake-progress__fill" id="progressFill" style="width: 20%"></div>
                </div>
                <p class="intake-progress__text" id="progressText">Step 1 of 5</p>
            </div>

            <!-- Form -->
            <form class="intake-form" id="intakeForm" action="https://formspree.io/f/xnjjgoay" method="POST">
                <input type="hidden" name="source" value="exploratory-guided-intake">
                <input type="hidden" name="tier" value="EXPLORATORY">
                <input type="hidden" name="entry_type" value="GUIDED_INTAKE">

                <!-- Step 1: Contact Info -->
                <div class="intake-step active" data-step="1">
                    <h2 class="intake-step__title">Let's start with the basics</h2>

                    <div class="intake-form__group">
                        <label class="intake-form__label" for="name">Your name</label>
                        <input type="text" id="name" name="name" class="intake-form__input" placeholder="First and last name" required>
                    </div>

                    <div class="intake-form__group">
                        <label class="intake-form__label" for="email">Email address</label>
                        <input type="email" id="email" name="email" class="intake-form__input" placeholder="you@example.com" required>
                    </div>

                    <div class="intake-form__group">
                        <label class="intake-form__label" for="phone">Phone number <span>(optional)</span></label>
                        <input type="tel" id="phone" name="phone" class="intake-form__input" placeholder="705-555-1234">
                    </div>
                </div>

                <!-- Step 2: Business Info -->
                <div class="intake-step" data-step="2">
                    <h2 class="intake-step__title">About your business</h2>

                    <div class="intake-form__group">
                        <label class="intake-form__label" for="business">Business name</label>
                        <input type="text" id="business" name="business" class="intake-form__input" placeholder="Your business or project name" required>
                    </div>

                    <div class="intake-form__group">
                        <label class="intake-form__label" for="website">Current website <span>(if you have one)</span></label>
                        <input type="url" id="website" name="website" class="intake-form__input" placeholder="https://yourbusiness.com">
                    </div>

                    <div class="intake-form__group">
                        <label class="intake-form__label" for="industry">What do you do?</label>
                        <textarea id="industry" name="industry" class="intake-form__textarea" placeholder="Briefly describe your business, product, or service" required></textarea>
                    </div>
                </div>

                <!-- Step 3: What's Happening -->
                <div class="intake-step" data-step="3">
                    <h2 class="intake-step__title">What's going on?</h2>

                    <div class="intake-form__group">
                        <label class="intake-form__label">What best describes your situation?</label>
                        <div class="intake-options">
                            <label class="intake-option">
                                <input type="radio" name="situation" value="brand_unclear" required>
                                <div class="intake-option__content">
                                    <p class="intake-option__label">My brand feels unclear or inconsistent</p>
                                    <p class="intake-option__description">Messaging, positioning, or visual identity needs work</p>
                                </div>
                            </label>
                            <label class="intake-option">
                                <input type="radio" name="situation" value="website_not_working">
                                <div class="intake-option__content">
                                    <p class="intake-option__label">My website isn't working</p>
                                    <p class="intake-option__description">Outdated, confusing, not converting, or doesn't exist</p>
                                </div>
                            </label>
                            <label class="intake-option">
                                <input type="radio" name="situation" value="both">
                                <div class="intake-option__content">
                                    <p class="intake-option__label">Both brand and website need attention</p>
                                    <p class="intake-option__description">The whole thing feels disconnected or stale</p>
                                </div>
                            </label>
                            <label class="intake-option">
                                <input type="radio" name="situation" value="not_sure">
                                <div class="intake-option__content">
                                    <p class="intake-option__label">I'm not sure what I need</p>
                                    <p class="intake-option__description">Something's off, but I can't pinpoint it</p>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Context & Goals -->
                <div class="intake-step" data-step="4">
                    <h2 class="intake-step__title">A bit more context</h2>

                    <div class="intake-form__group">
                        <label class="intake-form__label" for="context">What's happening right now?</label>
                        <textarea id="context" name="context" class="intake-form__textarea" placeholder="Tell us what prompted you to reach out. What's frustrating? What would success look like?" required></textarea>
                        <p class="intake-form__help">A few sentences is fine. This helps us understand your situation.</p>
                    </div>

                    <div class="intake-form__group">
                        <label class="intake-form__label" for="outcome">What outcome would be most valuable?</label>
                        <textarea id="outcome" name="outcome" class="intake-form__textarea" placeholder="If we could help you with one thing, what would it be?"></textarea>
                    </div>
                </div>

                <!-- Step 5: Budget & Timeline -->
                <div class="intake-step" data-step="5">
                    <h2 class="intake-step__title">Logistics</h2>

                    <div class="intake-form__group">
                        <label class="intake-form__label" for="budget">Investment range</label>
                        <select id="budget" name="budget" class="intake-form__select" required>
                            <option value="">Select a range...</option>
                            <option value="under_250">Under $250</option>
                            <option value="250_750">$250 – $750</option>
                            <option value="750_2500">$750 – $2,500</option>
                            <option value="2500_10000">$2,500 – $10,000</option>
                            <option value="10000_plus">$10,000+</option>
                            <option value="not_sure">Not sure yet</option>
                        </select>
                        <p class="intake-form__help">This helps us recommend the right path. No commitment.</p>
                    </div>

                    <div class="intake-form__group">
                        <label class="intake-form__label" for="timeline">Timeline</label>
                        <select id="timeline" name="timeline" class="intake-form__select" required>
                            <option value="">When do you need this?</option>
                            <option value="asap">ASAP — urgent</option>
                            <option value="2_4_weeks">Within 2–4 weeks</option>
                            <option value="1_3_months">1–3 months</option>
                            <option value="exploring">Just exploring for now</option>
                        </select>
                    </div>

                    <div class="intake-form__group">
                        <label class="intake-form__label" for="contact_pref">Preferred contact method</label>
                        <select id="contact_pref" name="contact_pref" class="intake-form__select">
                            <option value="email">Email</option>
                            <option value="phone">Phone call</option>
                            <option value="video">Video call</option>
                        </select>
                    </div>
                </div>

                <!-- Navigation -->
                <div class="intake-nav">
                    <button type="button" class="intake-nav__btn intake-nav__btn--back intake-nav__btn--hidden" id="backBtn">Back</button>
                    <button type="button" class="intake-nav__btn intake-nav__btn--next" id="nextBtn">Continue</button>
                    <button type="submit" class="intake-nav__btn intake-nav__btn--submit" id="submitBtn" style="display: none;">Submit</button>
                </div>
            </form>

            <!-- Success State -->
            <div class="intake-success" id="successState">
                <div class="intake-success__icon">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                    </svg>
                </div>
                <h2 class="intake-success__title">We've got it</h2>
                <p class="intake-success__text">
                    Thanks for sharing. We'll review your responses within 1–2 business days and follow up with a clear next step.
                </p>

                <div class="intake-success__next">
                    <p class="intake-success__next-title">What happens next?</p>
                    <p class="intake-success__next-text">
                        We'll review your intake and determine the best path forward. You might hear back with a recommendation, a question, or an invite to a Discovery Call. Either way, you'll know where you stand.
                    </p>
                </div>

                <p class="intake-success__alt">
                    Need clarity now? <a href="/exploratory">Book a Clarity Session</a> ($145 CAD)
                </p>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="intake-footer">
        <p class="intake-footer__text">&copy; <span class="js-year"></span> Bertrand Brands</p>
    </footer>

    <script>
        document.querySelectorAll('.js-year').forEach(el => el.textContent = new Date().getFullYear());

        const form = document.getElementById('intakeForm');
        const steps = document.querySelectorAll('.intake-step');
        const backBtn = document.getElementById('backBtn');
        const nextBtn = document.getElementById('nextBtn');
        const submitBtn = document.getElementById('submitBtn');
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');
        const successState = document.getElementById('successState');

        let currentStep = 1;
        const totalSteps = steps.length;

        function updateUI() {
            // Update steps visibility
            steps.forEach(step => {
                step.classList.remove('active');
                if (parseInt(step.dataset.step) === currentStep) {
                    step.classList.add('active');
                }
            });

            // Update progress
            const progress = (currentStep / totalSteps) * 100;
            progressFill.style.width = progress + '%';
            progressText.textContent = `Step ${currentStep} of ${totalSteps}`;

            // Update buttons
            backBtn.classList.toggle('intake-nav__btn--hidden', currentStep === 1);

            if (currentStep === totalSteps) {
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'block';
            } else {
                nextBtn.style.display = 'block';
                submitBtn.style.display = 'none';
            }
        }

        // Toast notification system
        function showToast(message, type = 'error') {
            // Remove existing toast
            const existingToast = document.querySelector('.intake-toast');
            if (existingToast) existingToast.remove();

            const toast = document.createElement('div');
            toast.className = `intake-toast intake-toast--${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);

            // Trigger animation
            requestAnimationFrame(() => {
                toast.classList.add('visible');
            });

            // Auto-hide after 4 seconds
            setTimeout(() => {
                toast.classList.remove('visible');
                setTimeout(() => toast.remove(), 300);
            }, 4000);
        }

        function validateField(field) {
            const group = field.closest('.intake-form__group');
            if (!group) return true;

            let isValid = true;
            let errorMsg = '';

            if (field.required && !field.value.trim()) {
                isValid = false;
                errorMsg = 'This field is required';
            } else if (field.type === 'email' && field.value && !field.value.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)) {
                isValid = false;
                errorMsg = 'Please enter a valid email address';
            } else if (field.type === 'tel' && field.value && !field.value.match(/^[\d\s\-\(\)\+]+$/)) {
                isValid = false;
                errorMsg = 'Please enter a valid phone number';
            } else if (field.type === 'url' && field.value && !field.value.match(/^https?:\/\/.+/)) {
                isValid = false;
                errorMsg = 'Please enter a valid URL (include https://)';
            }

            // Update visual state
            group.classList.toggle('has-error', !isValid);
            let errorEl = group.querySelector('.intake-form__error');
            if (!isValid) {
                if (!errorEl) {
                    errorEl = document.createElement('p');
                    errorEl.className = 'intake-form__error';
                    group.appendChild(errorEl);
                }
                errorEl.textContent = errorMsg;
            }

            return isValid;
        }

        function validateCurrentStep() {
            const currentStepEl = document.querySelector(`.intake-step[data-step="${currentStep}"]`);
            const requiredFields = currentStepEl.querySelectorAll('[required]');
            let valid = true;
            let firstInvalid = null;

            requiredFields.forEach(field => {
                if (field.type === 'radio') {
                    const radioGroup = currentStepEl.querySelectorAll(`input[name="${field.name}"]`);
                    const checked = Array.from(radioGroup).some(r => r.checked);
                    if (!checked) {
                        valid = false;
                        if (!firstInvalid) firstInvalid = field;
                    }
                } else {
                    const fieldValid = validateField(field);
                    if (!fieldValid) {
                        valid = false;
                        if (!firstInvalid) firstInvalid = field;
                    }
                }
            });

            if (!valid && firstInvalid) {
                showToast('Please fill in all required fields', 'error');
            }

            return valid;
        }

        // Add blur validation to all inputs
        form.querySelectorAll('.intake-form__input, .intake-form__textarea').forEach(field => {
            field.addEventListener('blur', () => validateField(field));
            field.addEventListener('input', () => {
                const group = field.closest('.intake-form__group');
                if (group && group.classList.contains('has-error')) {
                    validateField(field);
                }
            });
        });

        nextBtn.addEventListener('click', () => {
            if (validateCurrentStep()) {
                currentStep++;
                updateUI();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            } else {
                // Focus first invalid field
                const currentStepEl = document.querySelector(`.intake-step[data-step="${currentStep}"]`);
                const firstInvalid = currentStepEl.querySelector('.has-error input, .has-error textarea, [required]:invalid');
                if (firstInvalid) firstInvalid.focus();
            }
        });

        backBtn.addEventListener('click', () => {
            if (currentStep > 1) {
                currentStep--;
                updateUI();
            }
        });

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            if (!validateCurrentStep()) return;

            submitBtn.disabled = true;
            submitBtn.classList.add('intake-nav__btn--loading');

            const formData = new FormData(form);

            try {
                const response = await fetch(form.action, {
                    method: 'POST',
                    body: formData,
                    headers: { 'Accept': 'application/json' }
                });

                if (response.ok) {
                    form.classList.add('hidden');
                    document.querySelector('.intake-progress').style.display = 'none';
                    successState.classList.add('active');

                    // Notify backend (silent)
                    fetch('/api/notify', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            type: 'intake',
                            service: 'Exploratory Guided Intake',
                            tier: 'EXPLORATORY',
                            source: 'exploratory-guided-intake',
                            name: formData.get('name'),
                            email: formData.get('email'),
                            phone: formData.get('phone') || '',
                            business: formData.get('business'),
                            website: formData.get('website') || '',
                            industry: formData.get('industry'),
                            situation: formData.get('situation'),
                            context: formData.get('context'),
                            outcome: formData.get('outcome') || '',
                            budget: formData.get('budget'),
                            timeline: formData.get('timeline'),
                            contact_pref: formData.get('contact_pref')
                        })
                    }).catch(() => {});
                } else {
                    throw new Error('Submission failed');
                }
            } catch (error) {
                submitBtn.disabled = false;
                submitBtn.classList.remove('intake-nav__btn--loading');
                showToast('Something went wrong. Please try again.', 'error');
            }
        });

        updateUI();
    </script>
</body>
</html>
